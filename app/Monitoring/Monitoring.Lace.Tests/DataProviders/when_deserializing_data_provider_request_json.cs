using System;
using System.Diagnostics;
using Monitoring.Dashboard.UI.Core.Extensions;
using Newtonsoft.Json;
using Newtonsoft.Json.Linq;
using Xunit.Extensions;

namespace Monitoring.Unit.Tests.DataProviders
{
    public class when_deserializing_data_provider_request_json : Specification
    {

        private readonly string _json = ReqeustJson.Json;
        private Exception exception;
        public override void Observe()
        {
            
        }

        [Observation]
        public void then_json_request_information_should_be_derialized_correctly()
        {
            var request = DeserializeToDynamic(_json);
            Debug.WriteLine(request.ObjectToJson());
        }


        private static string DeserializeToDynamic(string json)
        {
          
            var requests = new JArray();

            var array = JArray.Parse(json);
            foreach (var item in array)
            {
               
                if (item is JArray)
                {
                    foreach (var nested in item)
                    {
                        dynamic request = JsonConvert.DeserializeObject(nested.ToString(Formatting.None));

                        if (request.Body.Payload != null && request.Body.Payload.Payload != null)
                        {

                            var token = JToken.Parse(request.Body.Payload.Payload.ToString());
                            if (token is JArray)
                            {
                                var payload = JArray.Parse(request.Body.Payload.Payload.ToString());
                                request.Body.Payload.Payload = payload;
                            }
                            else
                            {
                                var payload = JObject.Parse(request.Body.Payload.Payload.ToString());
                                request.Body.Payload.Payload = payload;
                            }
                           
                           
                        }

                        if (request.Body.Payload != null && request.Body.Payload.MetaData != null)
                        {
                            var token = JToken.Parse(request.Body.Payload.MetaData.ToString());
                            if (token is JArray)
                            {
                                var metaData = JArray.Parse(request.Body.Payload.MetaData.ToString());
                                request.Body.Payload.MetaData = metaData;
                            }
                            else
                            {
                                var metaData = JObject.Parse(request.Body.Payload.MetaData.ToString());
                                request.Body.Payload.MetaData = metaData;
                            }
                        }

                        //requests.Add(request.ToString());
                        requests.Add(JArray.Parse("[" + request.ToString() + "]"));
                    }
                }
                
            }
            return requests.ToString(Formatting.None);
        }

    }


    public static class ReqeustJson
    {
      public static readonly string Json = "[[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.RequestToDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":1,\"Name\":\"Ivid\",\"CostPrice\":15.0,\"RecommendedPrice\":30.0,\"Action\":1,\"State\":1},\"Date\":\"2015-04-21T19:53:29.5051904Z\",\"Connection\":{\"Type\":\"Web Service\",\"Connection\":\"https://secure1.ubiquitech.co.za/ivid/ws/hpiService.wsdl\"},\"Payload\":{\"MetaData\":\"{\\\"Metadata\\\":null,\\\"HasMetaData\\\":false}\",\"Payload\":\"[[{\\\"Package\\\":{\\\"Id\\\":\\\"f1f6fee5-a9bd-494a-aba2-56d23627f12d\\\",\\\"Version\\\":1,\\\"DataProviders\\\":[{\\\"Name\\\":0,\\\"CostPrice\\\":7.0,\\\"RecommendedPrice\\\":14.0}],\\\"Name\\\":\\\"LicensePlatePackage\\\",\\\"Action\\\":\\\"License plate search\\\"},\\\"User\\\":{\\\"UserId\\\":\\\"5a7222e1-ee65-433b-b673-827319e89cbb\\\",\\\"AggregateId\\\":\\\"a71ec7d0-2343-4ed0-a809-04a781117349\\\",\\\"UserName\\\":null,\\\"UserFirstName\\\":\\\"Murray\\\",\\\"UserLastName\\\":null,\\\"UserEmail\\\":\\\"murrayw@lightstone.co.za\\\",\\\"UserPhone\\\":null},\\\"Vehicle\\\":{\\\"EngineNo\\\":null,\\\"VinOrChassis\\\":null,\\\"Make\\\":null,\\\"RegisterNo\\\":null,\\\"LicenceNo\\\":\\\"CL49CTGP\\\",\\\"Vin\\\":null},\\\"Request\\\":{\\\"RequestId\\\":\\\"952f20cc-19fb-45a5-925e-d2c588fb1a8c\\\",\\\"System\\\":0,\\\"FromIpAddress\\\":\\\"196.165.10.2\\\",\\\"FromDeviceType\\\":3,\\\"OsVersion\\\":\\\"not available\\\"},\\\"RequestDate\\\":\\\"2015-04-21T21:53:29.5091906+02:00\\\",\\\"Contract\\\":{\\\"ContractId\\\":\\\"5b6dc4a1-c598-4751-8274-1ae366ac061a\\\",\\\"ContractVersion\\\":1,\\\"AccountNumber\\\":\\\"ACCRJ000000\\\"}}]]\",\"Message\":\"Start Executing Data Provider Ivid\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.ResponseFromDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":4,\"Name\":\"Rgt\",\"CostPrice\":30.0,\"RecommendedPrice\":60.0,\"Action\":2,\"State\":1},\"Date\":\"2015-04-21T19:53:30.553476Z\",\"Connection\":{\"Type\":\"Database\",\"Connection\":\"Data Source=.;Initial Catalog=Auto_Carstats;Integrated Security=True;\"},\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00.0012938\\\",\\\"Name\\\":\\\"Rgt\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"{\\\"Continue\\\":false,\\\"Result\\\":{\\\"Manufacturer\\\":null,\\\"ModelYear\\\":0,\\\"ModelType\\\":null,\\\"TopSpeed\\\":null,\\\"Kilowatts\\\":null,\\\"FuelEconomy\\\":null,\\\"Acceleration\\\":null,\\\"Torque\\\":null,\\\"Emissions\\\":null,\\\"EngineSize\\\":null,\\\"BodyShape\\\":null,\\\"FuelType\\\":null,\\\"TransmissionType\\\":null,\\\"CarFullname\\\":null,\\\"Colour\\\":null,\\\"RainSensorWindscreenWipers\\\":null,\\\"HeadUpDisplay\\\":null,\\\"VehicleType\\\":null,\\\"Model\\\":null,\\\"Make\\\":null,\\\"CarType\\\":null,\\\"TypeName\\\":\\\"RgtResponse\\\",\\\"Type\\\":\\\"Lace.Domain.Core.Entities.RgtResponse, Lightstone.DataPlatform.Lace.Domain.Core.Entities, Version=0.0.0.1, Culture=neutral, PublicKeyToken=null\\\",\\\"Handled\\\":false}}\",\"Message\":\"Stop Executing Data Provider Rgt\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.ResponseFromDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":1,\"Name\":\"Ivid\",\"CostPrice\":15.0,\"RecommendedPrice\":30.0,\"Action\":2,\"State\":1},\"Date\":\"2015-04-21T19:53:29.5201911Z\",\"Connection\":{\"Type\":\"Web Service\",\"Connection\":\"https://secure1.ubiquitech.co.za/ivid/ws/hpiService.wsdl\"},\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00.0092916\\\",\\\"Name\\\":\\\"Ivid\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"{\\\"SpecificInformation\\\":null,\\\"StatusMessage\\\":null,\\\"Reference\\\":null,\\\"License\\\":null,\\\"Registration\\\":null,\\\"RegistrationDate\\\":null,\\\"Vin\\\":null,\\\"Engine\\\":null,\\\"Displacement\\\":null,\\\"Tare\\\":null,\\\"MakeCode\\\":null,\\\"MakeDescription\\\":null,\\\"ModelCode\\\":null,\\\"ModelDescription\\\":null,\\\"ColourCode\\\":null,\\\"ColourDescription\\\":null,\\\"DrivenCode\\\":null,\\\"DrivenDescription\\\":null,\\\"CategoryCode\\\":null,\\\"CategoryDescription\\\":null,\\\"DescriptionCode\\\":null,\\\"Description\\\":null,\\\"EconomicSectorCode\\\":null,\\\"EconomicSectorDescription\\\":null,\\\"LifeStatusCode\\\":null,\\\"LifeStatusDescription\\\":null,\\\"SapMarkCode\\\":null,\\\"SapMarkDescription\\\":null,\\\"HasIssues\\\":false,\\\"HasErrors\\\":false,\\\"CarFullname\\\":null,\\\"TypeName\\\":\\\"IvidResponse\\\",\\\"Type\\\":\\\"Lace.Domain.Core.Entities.IvidResponse, Lightstone.DataPlatform.Lace.Domain.Core.Entities, Version=0.0.0.1, Culture=neutral, PublicKeyToken=null\\\",\\\"Handled\\\":false}\",\"Message\":\"Stop Executing Data Provider Ivid\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.RequestToDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":2,\"Name\":\"IvidTitleHolder\",\"CostPrice\":35.0,\"RecommendedPrice\":70.0,\"Action\":1,\"State\":1},\"Date\":\"2015-04-21T19:53:30.2112302Z\",\"Connection\":{\"Type\":\"Web Service\",\"Connection\":\"https://secure1.ubiquitech.co.za:443/ivid/ws/\"},\"Payload\":{\"MetaData\":\"{\\\"Metadata\\\":null,\\\"HasMetaData\\\":false}\",\"Payload\":\"[[{\\\"User\\\":{\\\"UserId\\\":\\\"5a7222e1-ee65-433b-b673-827319e89cbb\\\",\\\"AggregateId\\\":\\\"01544b3e-49d7-4883-9a4a-85866a051760\\\",\\\"UserName\\\":null,\\\"UserFirstName\\\":\\\"Murray\\\",\\\"UserLastName\\\":null,\\\"UserEmail\\\":\\\"murrayw@lightstone.co.za\\\",\\\"UserPhone\\\":null},\\\"Vehicle\\\":{\\\"EngineNo\\\":null,\\\"VinOrChassis\\\":null,\\\"Make\\\":null,\\\"RegisterNo\\\":null,\\\"LicenceNo\\\":\\\"XMC167GP\\\",\\\"Vin\\\":null},\\\"Request\\\":{\\\"RequestId\\\":\\\"03ccfc37-6697-4b11-9086-61da4c0bfc09\\\",\\\"System\\\":0,\\\"FromIpAddress\\\":\\\"196.165.10.2\\\",\\\"FromDeviceType\\\":3,\\\"OsVersion\\\":\\\"not available\\\"},\\\"RequestDate\\\":\\\"2015-04-21T21:53:30.2162304+02:00\\\",\\\"Package\\\":{\\\"Id\\\":\\\"c00b796e-6fb5-403d-9dc3-dfdd7f760f6f\\\",\\\"Version\\\":1,\\\"DataProviders\\\":[{\\\"Name\\\":1,\\\"CostPrice\\\":18.0,\\\"RecommendedPrice\\\":36.0}],\\\"Name\\\":\\\"LicensePlatePackage\\\",\\\"Action\\\":\\\"License plate search\\\"},\\\"Contract\\\":{\\\"ContractId\\\":\\\"5b6dc4a1-c598-4751-8274-1ae366ac061a\\\",\\\"ContractVersion\\\":1,\\\"AccountNumber\\\":\\\"ACCRJ000000\\\"}}]]\",\"Message\":\"Start Executing Data Provider IvidTitleHolder\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.ResponseFromDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":2,\"Name\":\"IvidTitleHolder\",\"CostPrice\":35.0,\"RecommendedPrice\":70.0,\"Action\":2,\"State\":1},\"Date\":\"2015-04-21T19:53:30.2202306Z\",\"Connection\":{\"Type\":\"Web Service\",\"Connection\":\"https://secure1.ubiquitech.co.za:443/ivid/ws/\"},\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00.0032252\\\",\\\"Name\\\":\\\"IvidTitleHolder\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"{\\\"Message\\\":{\\\"bankName\\\":\\\"WesBank\\\",\\\"flaggedOnAnpr\\\":false,\\\"partialResponse\\\":false,\\\"accountNumber\\\":\\\"00009009838\\\",\\\"accountOpenDate\\\":\\\"2005-04-21T21:53:30.2182309+02:00\\\",\\\"accountOpenDateSpecified\\\":true,\\\"accountClosedDate\\\":\\\"2010-04-21T21:53:30.2172305+02:00\\\",\\\"accountClosedDateSpecified\\\":true,\\\"yearOfLiabilityForLicensing\\\":null,\\\"make\\\":\\\"Toyota\\\",\\\"model\\\":\\\"Hilux\\\",\\\"vin\\\":\\\"AHT31UNK408007735\\\",\\\"engineNumber\\\":null},\\\"Result\\\":{\\\"BankName\\\":null,\\\"AccountNumber\\\":null,\\\"DateOpened\\\":null,\\\"FlaggedOnAnpr\\\":false,\\\"FinancialInterestsHeading\\\":\\\"Financial Interests\\\",\\\"AccountOpenDate\\\":null,\\\"AccountClosedDate\\\":null,\\\"AgreementType\\\":\\\"Regular Finance Contract\\\",\\\"YearOfLiabilityForLicensing\\\":null,\\\"RequestFinancialInterestInvite\\\":null,\\\"FinancialInterestAvailable\\\":false,\\\"PartialResponse\\\":false,\\\"HasErrors\\\":false,\\\"ExpiredMessage\\\":\\\"This report is older than 15 days, we recommend you generate a new one as information may have changed since then\\\",\\\"TypeName\\\":\\\"IvidTitleHolderResponse\\\",\\\"Type\\\":\\\"Lace.Domain.Core.Entities.IvidTitleHolderResponse, Lightstone.DataPlatform.Lace.Domain.Core.Entities, Version=0.0.0.1, Culture=neutral, PublicKeyToken=null\\\",\\\"Handled\\\":false},\\\"Continue\\\":true}\",\"Message\":\"Stop Executing Data Provider IvidTitleHolder\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.EntryPointReceivedRequest, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"Date\":\"2015-04-21T19:53:28.9451586Z\",\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00\\\",\\\"Name\\\":\\\"EntryPoint\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"[[{\\\"User\\\":{\\\"UserId\\\":\\\"5a7222e1-ee65-433b-b673-827319e89cbb\\\",\\\"AggregateId\\\":\\\"93489426-b6d5-4fc0-9360-5631e0a04551\\\",\\\"UserName\\\":null,\\\"UserFirstName\\\":\\\"Murray\\\",\\\"UserLastName\\\":null,\\\"UserEmail\\\":\\\"murrayw@lightstone.co.za\\\",\\\"UserPhone\\\":null},\\\"Vehicle\\\":{\\\"EngineNo\\\":null,\\\"VinOrChassis\\\":null,\\\"Make\\\":null,\\\"RegisterNo\\\":null,\\\"LicenceNo\\\":\\\"CL49CTGP\\\",\\\"Vin\\\":null},\\\"Request\\\":{\\\"RequestId\\\":\\\"88d22e7e-6662-4e26-968b-93495a8ff961\\\",\\\"System\\\":0,\\\"FromIpAddress\\\":\\\"196.165.10.2\\\",\\\"FromDeviceType\\\":3,\\\"OsVersion\\\":\\\"not available\\\"},\\\"RequestDate\\\":\\\"2015-04-21T21:53:28.9101563+02:00\\\",\\\"Package\\\":{\\\"Id\\\":\\\"46cf925a-b2ba-4a2a-a177-c612a0fb1445\\\",\\\"Version\\\":1,\\\"DataProviders\\\":[{\\\"Name\\\":0,\\\"CostPrice\\\":5.0,\\\"RecommendedPrice\\\":10.0},{\\\"Name\\\":4,\\\"CostPrice\\\":6.0,\\\"RecommendedPrice\\\":12.0},{\\\"Name\\\":1,\\\"CostPrice\\\":7.0,\\\"RecommendedPrice\\\":14.0},{\\\"Name\\\":3,\\\"CostPrice\\\":8.0,\\\"RecommendedPrice\\\":16.0},{\\\"Name\\\":2,\\\"CostPrice\\\":9.0,\\\"RecommendedPrice\\\":18.0},{\\\"Name\\\":5,\\\"CostPrice\\\":10.0,\\\"RecommendedPrice\\\":20.0}],\\\"Name\\\":\\\"LicensePlatePackage\\\",\\\"Action\\\":\\\"License plate search\\\"},\\\"Contract\\\":{\\\"ContractId\\\":\\\"5b6dc4a1-c598-4751-8274-1ae366ac061a\\\",\\\"ContractVersion\\\":1,\\\"AccountNumber\\\":\\\"ACCRJ000000\\\"}}]]\",\"Message\":\"Received Request in LACE\"},\"Request\":{\"Id\":1,\"Type\":\"LicenseSearch\",\"SearchTerm\":\"CL49CTGP\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.ResponseFromDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Name\":\"Audatex\",\"Action\":2,\"State\":1},\"Date\":\"2015-04-21T19:53:30.7099828Z\",\"Connection\":{\"Type\":\"Web Service\",\"Connection\":\"https://mobile.za.ax-aee.co.uk/audabridge/backofficeservice.asmx\"},\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00.0100451\\\",\\\"Name\\\":\\\"Audatex\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"{\\\"Message\\\":{\\\"ErrorCode\\\":0,\\\"ErrorMessage\\\":\\\"OK\\\",\\\"MessageId\\\":0,\\\"MessageTypeIdentifier\\\":\\\"MSGTYPE_HISTORYRESPONSE\\\",\\\"QueueDepth\\\":0,\\\"MessageEnvelope\\\":\\\"<MsgData><Header><MsgTypeIdentifier /><Reference /></Header><Body><EntityList><HistoryCheckResponse><AssessmentNumber>4243</AssessmentNumber><ClaimReferenceNumber>94411</ClaimReferenceNumber><CreationDate>2011-01-12T00:00:00</CreationDate><DataSource>Santam</DataSource><InsuredName>Lightstone</InsuredName><Manufacturer>Hyundai</Manufacturer><Model>Atos</Model><Originator>Audatex</Originator><PolicyNumber>3U7WDLX0</PolicyNumber><Registration>BB30DPGP</Registration><RepairCostExVAT>10000</RepairCostExVAT><RepairCostIncVAT>14000</RepairCostIncVAT><VersionDate>2012-08-08T14:42:18.3328811+02:00</VersionDate><VIN>MALAC51HLAM496530</VIN><WorkproviderReference /></HistoryCheckResponse></EntityList></Body></MsgData>\\\"},\\\"Result\\\":{\\\"TypeName\\\":\\\"AudatexResponse\\\",\\\"Type\\\":\\\"Lace.Domain.Core.Entities.AudatexResponse, Lightstone.DataPlatform.Lace.Domain.Core.Entities, Version=0.0.0.1, Culture=neutral, PublicKeyToken=null\\\",\\\"Handled\\\":false,\\\"AccidentClaims\\\":[],\\\"HasAccidentClaims\\\":false},\\\"Continue\\\":true}\",\"Message\":\"Stop Executing Data Provider Audatex\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.RequestToDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Name\":\"Audatex\",\"Action\":1,\"State\":1},\"Date\":\"2015-04-21T19:53:30.6919722Z\",\"Connection\":{\"Type\":\"Web Service\",\"Connection\":\"https://mobile.za.ax-aee.co.uk/audabridge/backofficeservice.asmx\"},\"Payload\":{\"MetaData\":\"{\\\"Metadata\\\":null,\\\"HasMetaData\\\":false}\",\"Payload\":\"[[{\\\"User\\\":{\\\"UserId\\\":\\\"5a7222e1-ee65-433b-b673-827319e89cbb\\\",\\\"AggregateId\\\":\\\"4572377e-f683-4669-acc3-a0fe52fda95d\\\",\\\"UserName\\\":null,\\\"UserFirstName\\\":\\\"Murray\\\",\\\"UserLastName\\\":null,\\\"UserEmail\\\":\\\"murrayw@lightstone.co.za\\\",\\\"UserPhone\\\":null},\\\"Vehicle\\\":{\\\"EngineNo\\\":null,\\\"VinOrChassis\\\":null,\\\"Make\\\":null,\\\"RegisterNo\\\":null,\\\"LicenceNo\\\":\\\"CL49CTGP\\\",\\\"Vin\\\":null},\\\"Request\\\":{\\\"RequestId\\\":\\\"a9f80774-b6fc-43bf-bc80-8abced9d4c87\\\",\\\"System\\\":0,\\\"FromIpAddress\\\":\\\"196.165.10.2\\\",\\\"FromDeviceType\\\":3,\\\"OsVersion\\\":\\\"not available\\\"},\\\"RequestDate\\\":\\\"2015-04-21T21:53:30.6989741+02:00\\\",\\\"Package\\\":{\\\"Id\\\":\\\"d8841043-4e0e-4969-853e-7055350dc6ce\\\",\\\"Version\\\":1,\\\"DataProviders\\\":[{\\\"Name\\\":5,\\\"CostPrice\\\":16.0,\\\"RecommendedPrice\\\":32.1}],\\\"Name\\\":\\\"LicensePlatePackage\\\",\\\"Action\\\":\\\"License plate search\\\"},\\\"Contract\\\":{\\\"ContractId\\\":\\\"5b6dc4a1-c598-4751-8274-1ae366ac061a\\\",\\\"ContractVersion\\\":1,\\\"AccountNumber\\\":\\\"ACCRJ000000\\\"}}]]\",\"Message\":\"Start Executing Data Provider Audatex\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.EntryPointReturnedResponse, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"Date\":\"2015-04-21T19:53:30.7889772Z\",\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00\\\",\\\"Name\\\":\\\"EntryPoint\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"{\\\"SpecificInformation\\\":null,\\\"StatusMessage\\\":null,\\\"Reference\\\":null,\\\"License\\\":null,\\\"Registration\\\":null,\\\"RegistrationDate\\\":null,\\\"Vin\\\":null,\\\"Engine\\\":null,\\\"Displacement\\\":null,\\\"Tare\\\":null,\\\"MakeCode\\\":null,\\\"MakeDescription\\\":null,\\\"ModelCode\\\":null,\\\"ModelDescription\\\":null,\\\"ColourCode\\\":null,\\\"ColourDescription\\\":null,\\\"DrivenCode\\\":null,\\\"DrivenDescription\\\":null,\\\"CategoryCode\\\":null,\\\"CategoryDescription\\\":null,\\\"DescriptionCode\\\":null,\\\"Description\\\":null,\\\"EconomicSectorCode\\\":null,\\\"EconomicSectorDescription\\\":null,\\\"LifeStatusCode\\\":null,\\\"LifeStatusDescription\\\":null,\\\"SapMarkCode\\\":null,\\\"SapMarkDescription\\\":null,\\\"HasIssues\\\":false,\\\"HasErrors\\\":false,\\\"CarFullname\\\":null,\\\"TypeName\\\":\\\"IvidResponse\\\",\\\"Type\\\":\\\"Lace.Domain.Core.Entities.IvidResponse, Lightstone.DataPlatform.Lace.Domain.Core.Entities, Version=0.0.0.1, Culture=neutral, PublicKeyToken=null\\\",\\\"Handled\\\":false}\",\"Message\":\"Return Response from LACE\"},\"State\":{\"Id\":1,\"Name\":\"Successful\"},\"RequestContext\":{\"Id\":1,\"Type\":\"LicenseSearch\",\"SearchTerm\":\"CL49CTGP\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.ResponseFromDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":3,\"Name\":\"RgtVin\",\"CostPrice\":25.0,\"RecommendedPrice\":50.0,\"Action\":2,\"State\":1},\"Date\":\"2015-04-21T19:53:30.4054501Z\",\"Connection\":{\"Type\":\"Database\",\"Connection\":\"Data Source=.;Initial Catalog=Auto_Carstats;Integrated Security=True;\"},\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00.0024228\\\",\\\"Name\\\":\\\"RgtVin\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"{\\\"Result\\\":{\\\"Vin\\\":null,\\\"VehicleMake\\\":null,\\\"VehicleType\\\":null,\\\"VehicleModel\\\":null,\\\"Year\\\":null,\\\"Month\\\":null,\\\"Quarter\\\":null,\\\"RgtCode\\\":null,\\\"Price\\\":null,\\\"Colour\\\":null,\\\"CarFullname\\\":null,\\\"TypeName\\\":\\\"RgtVinResponse\\\",\\\"Type\\\":\\\"Lace.Domain.Core.Entities.RgtVinResponse, Lightstone.DataPlatform.Lace.Domain.Core.Entities, Version=0.0.0.1, Culture=neutral, PublicKeyToken=null\\\",\\\"Handled\\\":false},\\\"Continue\\\":true}\",\"Message\":\"Stop Executing Data Provider RgtVin\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Billing.Messages.Publishable.BillTransactionMessage, Lightstone.DataPlatform.Workflow.Billing.Messages\",\"PackageIdentifier\":{\"Id\":\"e2e91bea-b301-4cad-a58a-425bc613c22c\",\"Version\":{\"Number\":1}},\"UserIdentifier\":{\"Id\":\"7a6e95c4-46b6-460a-89e6-259ba6792fd0\"},\"RequestIdentifier\":{\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"System\":{\"Name\":\"API\",\"Server\":{\"MachineName\":\"APPSURE-PC5\",\"LocalIP\":\"192.168.56.1\"}}},\"TransactionDate\":\"2015-04-21T19:53:30.790978Z\",\"TransactionId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"State\":{\"Id\":1,\"Name\":\"Successful\"},\"Contract\":{\"Id\":\"5b6dc4a1-c598-4751-8274-1ae366ac061a\",\"Version\":{}},\"Account\":{\"AccountNumber\":\"UNITTEST0001\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.RequestToDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":3,\"Name\":\"RgtVin\",\"CostPrice\":25.0,\"RecommendedPrice\":50.0,\"Action\":1,\"State\":1},\"Date\":\"2015-04-21T19:53:30.4004686Z\",\"Connection\":{\"Type\":\"Database\",\"Connection\":\"Data Source=.;Initial Catalog=Auto_Carstats;Integrated Security=True;\"},\"Payload\":{\"MetaData\":\"{\\\"Metadata\\\":null,\\\"HasMetaData\\\":false}\",\"Payload\":\"[[{\\\"User\\\":{\\\"UserId\\\":\\\"5a7222e1-ee65-433b-b673-827319e89cbb\\\",\\\"AggregateId\\\":\\\"ea4c6db8-c20e-40cf-b611-d8d95fde85ca\\\",\\\"UserName\\\":null,\\\"UserFirstName\\\":\\\"Murray\\\",\\\"UserLastName\\\":null,\\\"UserEmail\\\":\\\"murrayw@lightstone.co.za\\\",\\\"UserPhone\\\":null},\\\"Vehicle\\\":{\\\"EngineNo\\\":null,\\\"VinOrChassis\\\":null,\\\"Make\\\":null,\\\"RegisterNo\\\":null,\\\"LicenceNo\\\":\\\"CL49CTGP\\\",\\\"Vin\\\":null},\\\"Request\\\":{\\\"RequestId\\\":\\\"99fe9e1a-b622-470c-bdc7-829b2fb8c483\\\",\\\"System\\\":0,\\\"FromIpAddress\\\":\\\"196.165.10.2\\\",\\\"FromDeviceType\\\":3,\\\"OsVersion\\\":\\\"not available\\\"},\\\"RequestDate\\\":\\\"2015-04-21T21:53:30.4024679+02:00\\\",\\\"Package\\\":{\\\"Id\\\":\\\"22489dde-93df-4376-9c09-0cfd629bc7e8\\\",\\\"Version\\\":1,\\\"DataProviders\\\":[{\\\"Name\\\":3,\\\"CostPrice\\\":5.0,\\\"RecommendedPrice\\\":10.0}],\\\"Name\\\":\\\"LicensePlatePackage\\\",\\\"Action\\\":\\\"License plate search\\\"},\\\"Contract\\\":{\\\"ContractId\\\":\\\"5b6dc4a1-c598-4751-8274-1ae366ac061a\\\",\\\"ContractVersion\\\":1,\\\"AccountNumber\\\":\\\"ACCRJ000000\\\"}}]]\",\"Message\":\"Start Executing Data Provider RgtVin\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.ResponseFromDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":5,\"Name\":\"LightstoneAuto\",\"CostPrice\":20.0,\"RecommendedPrice\":40.0,\"Action\":2,\"State\":1},\"Date\":\"2015-04-21T19:53:30.1242259Z\",\"Connection\":{\"Type\":\"Database\",\"Connection\":\"Data Source=.;Initial Catalog=Auto_Carstats;Integrated Security=True;\"},\"Payload\":{\"MetaData\":\"{\\\"Results\\\":{\\\"ElapsedTime\\\":\\\"00:00:00.2977478\\\",\\\"Name\\\":\\\"LightstoneAuto\\\"},\\\"HasResults\\\":true}\",\"Payload\":\"{\\\"CarId\\\":null,\\\"Year\\\":null,\\\"Vin\\\":null,\\\"ImageUrl\\\":null,\\\"Quarter\\\":null,\\\"CarFullname\\\":null,\\\"Model\\\":null,\\\"VehicleValuation\\\":null,\\\"TypeName\\\":\\\"LightstoneAutoResponse\\\",\\\"Type\\\":\\\"Lace.Domain.Core.Entities.LightstoneAutoResponse, Lightstone.DataPlatform.Lace.Domain.Core.Entities, Version=0.0.0.1, Culture=neutral, PublicKeyToken=null\\\",\\\"Handled\\\":false}\",\"Message\":\"Stop Executing Data Provider LightstoneAuto\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.RequestToDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":5,\"Name\":\"LightstoneAuto\",\"CostPrice\":20.0,\"RecommendedPrice\":40.0,\"Action\":1,\"State\":1},\"Date\":\"2015-04-21T19:53:29.822209Z\",\"Connection\":{\"Type\":\"Database\",\"Connection\":\"Data Source=.;Initial Catalog=Auto_Carstats;Integrated Security=True;\"},\"Payload\":{\"MetaData\":\"{\\\"Metadata\\\":null,\\\"HasMetaData\\\":false}\",\"Payload\":\"[[{\\\"User\\\":{\\\"UserId\\\":\\\"5a7222e1-ee65-433b-b673-827319e89cbb\\\",\\\"AggregateId\\\":\\\"c4512a36-97ab-43c8-a296-2c0e6c19afb0\\\",\\\"UserName\\\":null,\\\"UserFirstName\\\":\\\"Murray\\\",\\\"UserLastName\\\":null,\\\"UserEmail\\\":\\\"murrayw@lightstone.co.za\\\",\\\"UserPhone\\\":null},\\\"Vehicle\\\":{\\\"EngineNo\\\":null,\\\"VinOrChassis\\\":null,\\\"Make\\\":null,\\\"RegisterNo\\\":null,\\\"LicenceNo\\\":\\\"XMC167GP\\\",\\\"Vin\\\":null},\\\"Request\\\":{\\\"RequestId\\\":\\\"7ebefe9b-4f9b-43ed-9729-7edc6322de09\\\",\\\"System\\\":0,\\\"FromIpAddress\\\":\\\"196.165.10.2\\\",\\\"FromDeviceType\\\":3,\\\"OsVersion\\\":\\\"not available\\\"},\\\"RequestDate\\\":\\\"2015-04-21T21:53:29.825209+02:00\\\",\\\"Package\\\":{\\\"Id\\\":\\\"40b6b864-8da1-4c95-bfd1-69a6f1f33fe4\\\",\\\"Version\\\":1,\\\"DataProviders\\\":[{\\\"Name\\\":4,\\\"CostPrice\\\":90.0,\\\"RecommendedPrice\\\":92.0}],\\\"Name\\\":\\\"LicensePlatePackage\\\",\\\"Action\\\":\\\"License plate search\\\"},\\\"Contract\\\":{\\\"ContractId\\\":\\\"5b6dc4a1-c598-4751-8274-1ae366ac061a\\\",\\\"ContractVersion\\\":1,\\\"AccountNumber\\\":\\\"ACCRJ000000\\\"}}]]\",\"Message\":\"Start Executing Data Provider LightstoneAuto\"}}}],[{\"Headers\":{},\"Body\":{\"$type\":\"Workflow.Lace.Messages.Events.RequestToDataProvider, Lightstone.DataPlatform.Workflow.Lace.Messages\",\"Id\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"RequestId\":\"9ae44d8e-87df-42f5-a9ce-b9ee4c6b1bad\",\"DataProvider\":{\"Id\":4,\"Name\":\"Rgt\",\"CostPrice\":30.0,\"RecommendedPrice\":60.0,\"Action\":1,\"State\":1},\"Date\":\"2015-04-21T19:53:30.5494587Z\",\"Connection\":{\"Type\":\"Database\",\"Connection\":\"Data Source=.;Initial Catalog=Auto_Carstats;Integrated Security=True;\"},\"Payload\":{\"MetaData\":\"{\\\"Metadata\\\":null,\\\"HasMetaData\\\":false}\",\"Payload\":\"[[{\\\"User\\\":{\\\"UserId\\\":\\\"5a7222e1-ee65-433b-b673-827319e89cbb\\\",\\\"AggregateId\\\":\\\"c3e3dab9-06e4-4ba7-9cf7-03217a05ac6a\\\",\\\"UserName\\\":null,\\\"UserFirstName\\\":\\\"Murray\\\",\\\"UserLastName\\\":null,\\\"UserEmail\\\":\\\"murrayw@lightstone.co.za\\\",\\\"UserPhone\\\":null},\\\"Vehicle\\\":{\\\"EngineNo\\\":null,\\\"VinOrChassis\\\":null,\\\"Make\\\":null,\\\"RegisterNo\\\":null,\\\"LicenceNo\\\":\\\"CL49CTGP\\\",\\\"Vin\\\":null},\\\"Request\\\":{\\\"RequestId\\\":\\\"99225385-0fa8-48a6-84f0-233b24e6e119\\\",\\\"System\\\":0,\\\"FromIpAddress\\\":\\\"196.165.10.2\\\",\\\"FromDeviceType\\\":3,\\\"OsVersion\\\":\\\"not available\\\"},\\\"RequestDate\\\":\\\"2015-04-21T21:53:30.5514586+02:00\\\",\\\"Package\\\":{\\\"Id\\\":\\\"3001d996-2929-47e2-ba66-98d8c8781554\\\",\\\"Version\\\":1,\\\"DataProviders\\\":[{\\\"Name\\\":2,\\\"CostPrice\\\":17.0,\\\"RecommendedPrice\\\":33.0}],\\\"Name\\\":\\\"LicensePlatePackage\\\",\\\"Action\\\":\\\"License plate search\\\"},\\\"Contract\\\":{\\\"ContractId\\\":\\\"5b6dc4a1-c598-4751-8274-1ae366ac061a\\\",\\\"ContractVersion\\\":1,\\\"AccountNumber\\\":\\\"ACCRJ000000\\\"}}]]\",\"Message\":\"Start Executing Data Provider Rgt\"}}}]]";
    }
}
